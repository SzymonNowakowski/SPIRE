#ifndef __sp_gui_imp__
#define __sp_gui_imp__

/**
@file
Subclass of sp_gui, which is generated by wxFormBuilder.
*/

#include "sp_gui.h"

//// end generated include

#include <cstdlib>
#include <ctime>
#include "surface_projection.hpp"
#include "img_out.hpp"
#include <wx/wx.h>

/** Implementing sp_gui */
class sp_gui_imp : public sp_gui
{
	protected:
		// Handlers for sp_gui events.
                void ntucs_change( wxSpinEvent& event );
                void a_change( wxSpinDoubleEvent& event );
		void surface_change( wxCommandEvent& event );
		void d_change( wxSpinDoubleEvent& event );
		void theta_change( wxSpinDoubleEvent& event );
		void phi_change( wxSpinDoubleEvent& event );
		void h_change( wxSpinEvent& event );
		void k_change( wxSpinEvent& event );
		void l_change( wxSpinEvent& event );
		void slicewidth_change( wxSpinDoubleEvent& event );
		void sliceheight_change( wxSpinDoubleEvent& event );
		void button_redraw( wxCommandEvent& event );
		void button_preview( wxCommandEvent& event );
		void button_render( wxCommandEvent& event );
		void button_save( wxCommandEvent& event );  
		void button_quit( wxCommandEvent& event );
	public:
		/** Constructor */
		sp_gui_imp( wxWindow* parent );
	//// end generated class members

private:
  
  /// transfers all parameters from the gui into the sp obejct
  void update_parameters();

  /// Redraws the currently loaded image after resizeing the window
  void redraw();

  /// Updates the orientation from miller indeces
  void update_orientation_from_hkl();
  
  void compute_and_draw();

  //the bitmap to show
  wxBitmap *preview;
  //image object to convert 2D array to a bitmap and scale
  wxImage *img;

  //The object doing the calculations
  surface_projection *sp;

};

#endif // __sp_gui_imp__
